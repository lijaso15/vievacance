{"ast":null,"code":"/**\r\n * ChordLink module\r\n */\nimport * as tslib_1 from \"tslib\";\nimport { FlowDiagramLink } from \"./FlowDiagramLink\";\nimport { registry } from \"../../core/Registry\";\nimport { QuadraticCurve } from \"../../core/elements/QuadraticCurve\";\nimport * as $math from \"../../core/utils/Math\";\nimport * as $path from \"../../core/rendering/Path\";\n/**\r\n * ============================================================================\r\n * MAIN CLASS\r\n * ============================================================================\r\n * @hidden\r\n */\n\n/**\r\n * This class creates a link (waved color-filled line) between two nodes in a\r\n * Chord Diagram.\r\n *\r\n * @see {@link IChordLinkEvents} for a list of available events\r\n * @see {@link IChordLinkAdapters} for a list of available Adapters\r\n * @important\r\n */\n\nvar ChordLink =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(ChordLink, _super);\n  /**\r\n   * Constructor\r\n   */\n\n\n  function ChordLink() {\n    var _this = _super.call(this) || this;\n\n    _this.className = \"ChordLink\";\n    _this.middleLine = _this.createChild(QuadraticCurve);\n    _this.middleLine.shouldClone = false;\n    _this.middleLine.strokeOpacity = 0;\n\n    _this.applyTheme();\n\n    return _this;\n  }\n  /**\r\n   * (Re)validates (redraws) the link.\r\n   *\r\n   * @ignore Exclude from docs\r\n   */\n\n\n  ChordLink.prototype.validate = function () {\n    _super.prototype.validate.call(this);\n\n    if (!this.isTemplate) {\n      var startAngle = this.startAngle;\n      var endAngle = this.endAngle;\n      var arc = this.arc;\n      var radius = this.radius;\n      var fromNode = this.dataItem.fromNode;\n      var toNode = this.dataItem.toNode;\n      var fromX = 0;\n      var fromY = 0;\n\n      if (fromNode) {\n        fromX = fromNode.pixelX + fromNode.dx;\n        fromY = fromNode.pixelY + fromNode.dy;\n      }\n\n      var toX = 0;\n      var toY = 0;\n\n      if (toNode) {\n        toX = toNode.pixelX + toNode.dx;\n        toY = toNode.pixelY + toNode.dy;\n      }\n\n      if (radius > 0) {\n        var x1 = radius * $math.cos(startAngle) + fromX;\n        var y1 = radius * $math.sin(startAngle) + fromY;\n        var x2 = radius * $math.cos(endAngle) + toX;\n        var y2 = radius * $math.sin(endAngle) + toY; //let cpAngle = startAngle + arc + (endAngle - startAngle - arc) / 2;\n        //let arcWidth = $math.getDistance({x:x1, y:y1}, {x:x4, y:y4});\n        //let cpx = (arcWidth) * $math.cos(cpAngle);\n        //let cpy = (arcWidth) * $math.sin(cpAngle);\n\n        var cp = {\n          x: 0,\n          y: 0\n        };\n        var path = $path.moveTo({\n          x: x1,\n          y: y1\n        });\n        path += $path.arcTo(startAngle, arc, radius);\n        path += $path.quadraticCurveTo({\n          x: x2,\n          y: y2\n        }, cp);\n        path += $path.arcTo(endAngle, arc, radius);\n        path += $path.quadraticCurveTo({\n          x: x1,\n          y: y1\n        }, cp);\n\n        if (arc > 0) {\n          this.link.path = path;\n        } else {\n          this.link.path = \"\";\n        }\n\n        if (this.maskBullets) {\n          this.bulletsMask.path = path;\n          this.bulletsContainer.mask = this.bulletsMask;\n        }\n\n        var mAngle1 = startAngle + arc / 2;\n        var mAngle2 = endAngle + arc / 2;\n        var middleLine = this.middleLine;\n        middleLine.x1 = radius * $math.cos(mAngle1) + fromX;\n        middleLine.y1 = radius * $math.sin(mAngle1) + fromY;\n        middleLine.x2 = radius * $math.cos(mAngle2) + toX;\n        middleLine.y2 = radius * $math.sin(mAngle2) + toY;\n        middleLine.cpx = 0;\n        middleLine.cpy = 0;\n        middleLine.stroke = this.fill;\n        this.positionBullets();\n      }\n    }\n  };\n\n  Object.defineProperty(ChordLink.prototype, \"radius\", {\n    /**\r\n     * @return End Y\r\n     */\n    get: function () {\n      return this.getPropertyValue(\"radius\");\n    },\n\n    /**\r\n     * [radius description]\r\n     *\r\n     * @todo Description\r\n     * @param value End Y\r\n     */\n    set: function (value) {\n      this.setPropertyValue(\"radius\", value, true);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(ChordLink.prototype, \"arc\", {\n    /**\r\n     * @return [description]\r\n     */\n    get: function () {\n      return this.getPropertyValue(\"arc\");\n    },\n\n    /**\r\n     * [arc description]\r\n     *\r\n     * @todo Description\r\n     * @param value [description]\r\n     */\n    set: function (value) {\n      this.setPropertyValue(\"arc\", value, true);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return ChordLink;\n}(FlowDiagramLink);\n\nexport { ChordLink };\n/**\r\n * Register class in system, so that it can be instantiated using its name from\r\n * anywhere.\r\n *\r\n * @ignore\r\n */\n\nregistry.registeredClasses[\"ChordLink\"] = ChordLink;","map":null,"metadata":{},"sourceType":"module"}