{"ast":null,"code":"/**\r\n * TreeMap series module.\r\n */\nimport * as tslib_1 from \"tslib\";\n/**\r\n * ============================================================================\r\n * IMPORTS\r\n * ============================================================================\r\n * @hidden\r\n */\n\nimport { ColumnSeries, ColumnSeriesDataItem } from \"./ColumnSeries\";\nimport { visualProperties } from \"../../core/Sprite\";\nimport { registry } from \"../../core/Registry\";\nimport { InterfaceColorSet } from \"../../core/utils/InterfaceColorSet\";\nimport * as $type from \"../../core/utils/Type\";\nimport { RoundedRectangle } from \"../../core/elements/RoundedRectangle\";\nimport * as $object from \"../../core/utils/Object\";\n/**\r\n * ============================================================================\r\n * DATA ITEM\r\n * ============================================================================\r\n * @hidden\r\n */\n\n/**\r\n * Defines a [[DataItem]] for [[TreeMapSeries]].\r\n *\r\n * @see {@link DataItem}\r\n */\n\nvar TreeMapSeriesDataItem =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(TreeMapSeriesDataItem, _super);\n  /**\r\n   * Constructor\r\n   */\n\n\n  function TreeMapSeriesDataItem() {\n    var _this = _super.call(this) || this;\n\n    _this.className = \"TreeMapSeriesDataItem\";\n\n    _this.applyTheme();\n\n    return _this;\n  }\n\n  Object.defineProperty(TreeMapSeriesDataItem.prototype, \"parentName\", {\n    /**\r\n     * Data for the this particular item.\r\n     *\r\n     * @param value  Item's data\r\n     */\n    //public set dataContext(value: Object) {\n    //\tthis._dataContext = value;\n    //}\n\n    /**\r\n     * @return Item's data\r\n     */\n\n    /*\r\n    public get dataContext(): Object {\r\n       // It's because data of tree series is TreeMapDataItems.\r\n       if (this._dataContext) {\r\n           return (<any>this._dataContext).dataContext;\r\n       }\r\n    }*/\n\n    /**\r\n     * The name of the item's parent item.\r\n     *\r\n     * @return Parent name\r\n     */\n    get: function () {\n      var treeMapDataItem = this.treeMapDataItem;\n\n      if (treeMapDataItem && treeMapDataItem.parent) {\n        return treeMapDataItem.parent.name;\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(TreeMapSeriesDataItem.prototype, \"value\", {\n    /**\r\n     * Item's numeric value.\r\n     *\r\n     * @readonly\r\n     * @return Value\r\n     */\n    get: function () {\n      var treeMapDataItem = this.treeMapDataItem;\n\n      if (treeMapDataItem) {\n        return treeMapDataItem.value;\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(TreeMapSeriesDataItem.prototype, \"treeMapDataItem\", {\n    /**\r\n     * A corresponding data item from the tree map.\r\n     *\r\n     * @readonly\r\n     * @return Data item\r\n     */\n    get: function () {\n      return this._dataContext;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return TreeMapSeriesDataItem;\n}(ColumnSeriesDataItem);\n\nexport { TreeMapSeriesDataItem };\n/**\r\n * ============================================================================\r\n * MAIN CLASS\r\n * ============================================================================\r\n * @hidden\r\n */\n\n/**\r\n * Defines Series for a TreeMap chart.\r\n *\r\n * @see {@link ITreeMapSeriesEvents} for a list of available Events\r\n * @see {@link ITreeMapSeriesAdapters} for a list of available Adapters\r\n * @todo Example\r\n * @important\r\n */\n\nvar TreeMapSeries =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(TreeMapSeries, _super);\n  /**\r\n   * Constructor\r\n   */\n\n\n  function TreeMapSeries() {\n    var _this = _super.call(this) || this;\n\n    _this.className = \"TreeMapSeries\";\n\n    _this.applyTheme();\n\n    _this.fillOpacity = 1;\n    _this.strokeOpacity = 1;\n    _this.minBulletDistance = 0;\n    _this.columns.template.tooltipText = \"{parentName} {name}: {value}\"; //@todo add format number?\n\n    _this.columns.template.configField = \"config\";\n    var interfaceColors = new InterfaceColorSet();\n    _this.stroke = interfaceColors.getFor(\"background\");\n    _this.dataFields.openValueX = \"x0\";\n    _this.dataFields.valueX = \"x1\";\n    _this.dataFields.openValueY = \"y0\";\n    _this.dataFields.valueY = \"y1\";\n    _this.sequencedInterpolation = false;\n    _this.showOnInit = false; // otherwise nodes don't stack nicely to each other\n\n    _this.columns.template.pixelPerfect = false;\n    return _this;\n  }\n  /**\r\n   * Processes data item.\r\n   *\r\n   * @param dataItem     Data item\r\n   * @param dataContext  Raw data\r\n   * @param index        Index of the data item\r\n   */\n\n\n  TreeMapSeries.prototype.processDataItem = function (dataItem, dataContext) {\n    dataContext.seriesDataItem = dataItem; // save a reference here. dataContext is TreeMapDataItem and we need to know dataItem sometimes\n\n    _super.prototype.processDataItem.call(this, dataItem, dataContext);\n  };\n  /**\r\n   * Returns a new/empty DataItem of the type appropriate for this object.\r\n   *\r\n   * @see {@link DataItem}\r\n   * @return Data Item\r\n   */\n\n\n  TreeMapSeries.prototype.createDataItem = function () {\n    return new TreeMapSeriesDataItem();\n  };\n  /**\r\n   * Shows series.\r\n   *\r\n   * @param duration  Duration of fade in (ms)\r\n   * @return Animation\r\n   */\n\n\n  TreeMapSeries.prototype.show = function (duration) {\n    var interpolationDuration = this.defaultState.transitionDuration;\n\n    if ($type.isNumber(duration)) {\n      interpolationDuration = duration;\n    }\n\n    this.dataItems.each(function (dataItem) {\n      dataItem.treeMapDataItem.setWorkingValue(\"value\", dataItem.treeMapDataItem.values.value.value);\n    });\n    return _super.prototype.showReal.call(this, interpolationDuration);\n  };\n  /**\r\n   * Hides series.\r\n   *\r\n   * @param duration  Duration of fade out (ms)\r\n   * @return Animation\r\n   */\n\n\n  TreeMapSeries.prototype.hide = function (duration) {\n    var interpolationDuration = this.defaultState.transitionDuration;\n\n    if ($type.isNumber(duration)) {\n      interpolationDuration = duration;\n    }\n\n    var animation = _super.prototype.hideReal.call(this, interpolationDuration);\n\n    this.dataItems.each(function (dataItem) {\n      dataItem.treeMapDataItem.setWorkingValue(\"value\", 0);\n    });\n    return animation;\n  };\n  /**\r\n   * Process values.\r\n   *\r\n   * @ignore Exclude from docs\r\n   */\n\n\n  TreeMapSeries.prototype.processValues = function () {// Just overriding so that inherited method does not kick in.\n  };\n  /**\r\n   * @ignore\r\n   */\n\n\n  TreeMapSeries.prototype.dataChangeUpdate = function () {};\n  /**\r\n   * Processes JSON-based config before it is applied to the object.\r\n   *\r\n   * @ignore Exclude from docs\r\n   * @param config  Config\r\n   */\n\n\n  TreeMapSeries.prototype.processConfig = function (config) {\n    if (config) {\n      // Add empty data fields if the they are not set, so that XYSeries\n      // dataField check does not result in error.\n      if (!$type.hasValue(config.dataFields) || !$type.isObject(config.dataFields)) {\n        config.dataFields = {};\n      }\n    }\n\n    _super.prototype.processConfig.call(this, config);\n  };\n  /**\r\n   * Creates elements in related legend container, that mimics the look of this\r\n   * Series.\r\n   *\r\n   * @ignore Exclude from docs\r\n   * @param marker  Legend item container\r\n   */\n\n\n  TreeMapSeries.prototype.createLegendMarker = function (marker) {\n    var w = marker.pixelWidth;\n    var h = marker.pixelHeight;\n    marker.removeChildren();\n    var column = marker.createChild(RoundedRectangle);\n    column.shouldClone = false;\n    $object.copyProperties(this, column, visualProperties); //column.copyFrom(<any>this.columns.template);\n\n    column.padding(0, 0, 0, 0); // if columns will have padding (which is often), legend marker will be very narrow\n\n    column.width = w;\n    column.height = h;\n    var legendDataItem = marker.dataItem;\n    legendDataItem.color = column.fill;\n    legendDataItem.colorOrig = column.fill;\n  };\n\n  return TreeMapSeries;\n}(ColumnSeries);\n\nexport { TreeMapSeries };\n/**\r\n * Register class in system, so that it can be instantiated using its name from\r\n * anywhere.\r\n *\r\n * @ignore\r\n */\n\nregistry.registeredClasses[\"TreeMapSeries\"] = TreeMapSeries;\nregistry.registeredClasses[\"TreeMapSeriesDataItem\"] = TreeMapSeriesDataItem;","map":null,"metadata":{},"sourceType":"module"}