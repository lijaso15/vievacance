{"ast":null,"code":"import _objectSpread from \"/Users/Overseer/Desktop/vievacance/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/Users/Overseer/Desktop/vievacance/client/src/components/ManageMementos/EditMementos/EditMementos-container.js\";\nimport EditMementosView from \"./EditMementos-view.js\";\nimport axios from \"axios\";\nimport React from \"react\";\n\nvar EditMementos = function EditMementos(_ref) {\n  var owner = _ref.owner,\n      photos = _ref.photos,\n      title = _ref.title,\n      description = _ref.description,\n      id = _ref.id,\n      profilePicture = _ref.profilePicture,\n      username = _ref.username,\n      onClick = _ref.onClick,\n      loadData = _ref.loadData,\n      selectedPhotos = _ref.selectedPhotos,\n      cities = _ref.cities,\n      _id = _ref._id,\n      setError = _ref.setError,\n      wasCalled = _ref.wasCalled,\n      message = _ref.message;\n  console.log(wasCalled);\n\n  if (!wasCalled) {\n    window.onload = function () {\n      axios.get(\"/photos/\".concat(owner)).then(function (res) {\n        console.log(res.data);\n        loadData(res.data.map(function (p) {\n          return photos.includes(p.id) ? _objectSpread({}, p, {\n            active: true\n          }) : p;\n        }), \"PHOTOS\");\n      });\n      axios.get(\"/globeData\").then(function (res) {\n        loadData(res.data.map(function (c) {\n          return {\n            city: c.city,\n            country: c.country,\n            active: c.city + \", \" + c.country === title\n          };\n        }), \"CITIES\");\n      }).catch(function (err) {\n        return alert(err);\n      });\n      setError(\"ERR_EDIT\");\n    };\n  }\n\n  return React.createElement(EditMementosView, {\n    owner: owner,\n    photos: photos,\n    title: title,\n    description: description,\n    editMemento: function editMemento() {\n      if (!document.querySelector(\"select\").selectedIndex) {\n        setError(\"ERR_EDIT\", \"Select a city\");\n        return;\n      } else {\n        var city = cities[document.querySelector(\"select\").selectedIndex - 1].city;\n        var country = cities[document.querySelector(\"select\").selectedIndex - 1].country;\n        var _description = document.querySelector(\"textarea\").value;\n\n        var _photos = selectedPhotos.map(function (p) {\n          return p.id;\n        });\n\n        if (!_photos.length) {\n          setError(\"ERR_EDIT\", \"Select one or more photos\");\n          return;\n        } else if (!_description) {\n          setError(\"ERR_EDIT\", \"Write about your trip\");\n          return;\n        } else {\n          axios.post(\"/mementos/edit/\".concat(_id), {\n            description: _description,\n            photos: _photos,\n            city: city,\n            country: country\n          }).then(function (res) {\n            if (res.status === 200) {\n              setError(\"ERR_EDIT\", \"Success!\");\n              setTimeout(function () {\n                return window.location.reload();\n              }, 1000);\n            }\n          }).catch(function (err) {\n            return alert(err);\n          });\n        }\n      }\n    },\n    id: id,\n    profilePicture: profilePicture,\n    username: username,\n    onClick: onClick,\n    message: message,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54\n    },\n    __self: this\n  });\n};\n\nexport default EditMementos;","map":{"version":3,"sources":["/Users/Overseer/Desktop/vievacance/client/src/components/ManageMementos/EditMementos/EditMementos-container.js"],"names":["EditMementosView","axios","React","EditMementos","owner","photos","title","description","id","profilePicture","username","onClick","loadData","selectedPhotos","cities","_id","setError","wasCalled","message","console","log","window","onload","get","then","res","data","map","p","includes","active","c","city","country","catch","err","alert","document","querySelector","selectedIndex","value","length","post","status","setTimeout","location","reload"],"mappings":"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","sourcesContent":["import EditMementosView from \"./EditMementos-view.js\";\nimport axios from \"axios\";\nimport React from \"react\";\n\nconst EditMementos = ({\n  owner,\n  photos,\n  title,\n  description,\n  id,\n  profilePicture,\n  username,\n  onClick,\n  loadData,\n  selectedPhotos,\n  cities,\n  _id,\n  setError,\n  wasCalled,\n  message\n}) => {\n  console.log(wasCalled);\n  if (!wasCalled) {\n    window.onload = () => {\n      axios.get(`/photos/${owner}`).then(res => {\n        console.log(res.data);\n        loadData(\n          res.data.map(p => {\n            return photos.includes(p.id) ? { ...p, active: true } : p;\n          }),\n          \"PHOTOS\"\n        );\n      });\n      axios\n        .get(`/globeData`)\n        .then(res => {\n          loadData(\n            res.data.map(c => {\n              return {\n                city: c.city,\n                country: c.country,\n                active: c.city + \", \" + c.country === title\n              };\n            }),\n            \"CITIES\"\n          );\n        })\n        .catch(err => alert(err));\n      setError(\"ERR_EDIT\");\n    };\n  }\n\n  return (\n    <EditMementosView\n      owner={owner}\n      photos={photos}\n      title={title}\n      description={description}\n      editMemento={() => {\n        if (!document.querySelector(\"select\").selectedIndex) {\n          setError(\"ERR_EDIT\", \"Select a city\");\n          return;\n        } else {\n          const city =\n            cities[document.querySelector(\"select\").selectedIndex - 1].city;\n          const country =\n            cities[document.querySelector(\"select\").selectedIndex - 1].country;\n          const description = document.querySelector(\"textarea\").value;\n          const photos = selectedPhotos.map(p => p.id);\n\n          if (!photos.length) {\n            setError(\"ERR_EDIT\", \"Select one or more photos\");\n            return;\n          } else if (!description) {\n            setError(\"ERR_EDIT\", \"Write about your trip\");\n            return;\n          } else {\n            axios\n              .post(`/mementos/edit/${_id}`, {\n                description,\n                photos,\n                city,\n                country\n              })\n              .then(res => {\n                if (res.status === 200) {\n                  setError(\"ERR_EDIT\", \"Success!\");\n                  setTimeout(() => window.location.reload(), 1000);\n                }\n              })\n              .catch(err => alert(err));\n          }\n        }\n      }}\n      id={id}\n      profilePicture={profilePicture}\n      username={username}\n      onClick={onClick}\n      message={message}\n    />\n  );\n};\n\nexport default EditMementos;\n"]},"metadata":{},"sourceType":"module"}