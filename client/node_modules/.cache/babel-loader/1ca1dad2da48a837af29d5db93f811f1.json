{"ast":null,"code":"/**\r\n * Functionality related simulating of dragging of elements using keyboard.\r\n */\n\n/**\r\n * ============================================================================\r\n * IMPORTS\r\n * ============================================================================\r\n * @hidden\r\n */\nimport { getInteraction } from \"./Interaction\";\nimport { system } from \"../System\";\nimport * as $array from \"../utils/Array\";\n/**\r\n * [[InteractionKeyboardObject]] is used to simulate dragging of the `draggable`\r\n * element using keyboard arrows.\r\n *\r\n * @ignore Exclude from docs\r\n */\n\nvar InteractionKeyboardObject =\n/** @class */\nfunction () {\n  /**\r\n   * Constructor.\r\n   *\r\n   * @param io An InteractionObject\r\n   */\n  function InteractionKeyboardObject(io, ev) {\n    /**\r\n     * Indicates if this object has already been deleted. Any\r\n     * destruction/disposal code should take this into account when deciding\r\n     * wheter to run potentially costly disposal operations if they already have\r\n     * been run.\r\n     */\n    this._disposed = false;\n    /**\r\n     * Indicates direction of current horizontal movement.\r\n     *\r\n     * 0 - not moving horizontally\r\n     * 1 - moving right\r\n     * -1 - moving left\r\n     */\n\n    this.directionX = 0;\n    /**\r\n     * Indicates direction of current vertical movement.\r\n     *\r\n     * 0 - not moving vertically\r\n     * 1 - moving down\r\n     * -1 - moving up\r\n     */\n\n    this.directionY = 0;\n    this.interaction = io;\n    this.keyboardEvent = ev;\n    this._startedOn = new Date().getTime();\n    getInteraction().processDragStart(io);\n    system.animations.push(this);\n    this.update();\n  }\n  /**\r\n   * It's an update method which is called by the system if\r\n   * [[InteractionObject]] is used as animation.\r\n   *\r\n   * This will update coordinates of the element based on the movement\r\n   * directions.\r\n   */\n\n\n  InteractionKeyboardObject.prototype.update = function () {\n    // Init and get settings\n    var io = this.interaction;\n    var speed = getInteraction().getKeyboardOption(io, \"speed\"),\n        accelleration = getInteraction().getKeyboardOption(io, \"accelleration\"),\n        accellerationDelay = getInteraction().getKeyboardOption(io, \"accellerationDelay\"),\n        shift = {\n      x: 0,\n      y: 0\n    }; // If SHIFT key is pressed we slash speed by half and disable accelleration\n\n    if (this.keyboardEvent.shiftKey) {\n      speed *= 0.5;\n      accelleration = 1;\n    } // If CTRL is pressed we increase speed by x2\n    else if (this.keyboardEvent.ctrlKey) {\n        speed *= 2;\n      } // Get elapsed time\n\n\n    var ms = new Date().getTime() - this._startedOn;\n\n    var accelleratedMs = ms - accellerationDelay; // Add accellerated movement\n\n    if (accelleration > 0 && accelleratedMs > 0) {\n      var accellerationFactor = ms / accellerationDelay;\n      ms = accellerationDelay;\n      shift.x += this.directionX * (speed * accelleration * accellerationFactor * accelleratedMs);\n      shift.y += this.directionY * (speed * accelleration * accellerationFactor * accelleratedMs);\n    } // Calculate position\n\n\n    shift.x += this.directionX * (speed * ms);\n    shift.y += this.directionY * (speed * ms); // Simulate move on Interaction\n\n    getInteraction().handleTransformMove(io, shift, {\n      x: 0,\n      y: 0\n    }, this.keyboardEvent, true, false);\n  };\n  /**\r\n   * Returns if this object has been already been disposed.\r\n   *\r\n   * @return Is disposed?\r\n   */\n\n\n  InteractionKeyboardObject.prototype.isDisposed = function () {\n    return this._disposed;\n  };\n  /**\r\n   * Disposes this object. Removes from system animations.\r\n   */\n\n\n  InteractionKeyboardObject.prototype.dispose = function () {\n    if (!this._disposed) {\n      getInteraction().processDragStop(this.interaction);\n      $array.remove(system.animations, this);\n    }\n  };\n\n  return InteractionKeyboardObject;\n}();\n\nexport { InteractionKeyboardObject };","map":null,"metadata":{},"sourceType":"module"}